model:
  input_path: "./checkpoints/dslnet_wlasl_100_best_converted.pth"
  output_path: "./checkpoints/dslnet_wlasl_100_best_pruned.pth"
  model_type: "dslnet"
  num_classes: 100  

data:
  root_dir: "./wlasl_data/videos"
  json_file: "./wlasl_data/wlasl100_converted/WLASL100_converted.json"
  label_file: "./wlasl_data/wlasl_class_list.txt"


pruning:
  method: "structured_layer_wise"  # pipeline: structured -> layer_wise (unstructured)
  target_sparsity: 0.3
  iterations: 3

  structured:
    embed_dim: 240  

  global:
    pruning_method: "l1_unstructured"
    amount: 0.3

  layer_wise:
    enabled: true
    layers:
      # stream_shape (TSSNStream)
      "stream_shape.spatial_embed.0": 0.05    # Linear(63, 128)
      "stream_shape.spatial_embed.4": 0.05    # Linear(128, 64)
      "stream_shape.temporal_encoder.0.conv": 0.2   # Conv1d
      "stream_shape.temporal_encoder.1.conv": 0.2   # Conv1d
      
      # stream_traj (FTDEStream)
      "stream_traj.embed.0": 0.15             # Linear(3, 64)
      "stream_traj.temporal_encoder.0.conv": 0.2    # Conv1d
      "stream_traj.temporal_encoder.1.conv": 0.2    # Conv1d
      
      # attention 融合層
      "attention.0": 0.2                      # Linear(128, 32)
      "attention.2": 0.2                      # Linear(32, 128)
      
      # classifier 分類器
      "classifier.0": 0.2                     # Linear(128, 64)
      "classifier.4": 0.2                     # Linear(64, 100)


  iterative:
    enabled: false  # 禁用迭代剪枝，使用一次性剪枝
    iterations: 3
    fine_tune_epochs: 5
    fine_tune_lr: 1e-5


fine_tune:
  enabled: true
  epochs: 30
  learning_rate: 0.00001
  weight_decay: 0.0001
  device: "cpu"

training:
  batch_size: 32


evaluation:
  metrics: ["accuracy", "sparsity", "compression_ratio"]
  top_k: [1, 5]
  detailed_report: true


strategy:
  preserve_first_last: true  
  preserve_classifier: true  
  min_sparsity: 0.1         
  max_sparsity: 0.8         


device: "auto"

save:
  pruned_model_path: "./checkpoints/dslnet_wlasl_100_best_pruned.pth"

logging:
  log_dir: "./logs/pruning"
  save_masks: true     
  save_statistics: true 


compression:
  target_size_mb: null  
  target_flops: null    
  max_accuracy_drop: 0.05  
